---
title: "GÃ¶rselleÅŸtirme"
format:
  html:
    toc: true
    toc-depth: 2
    number-sections: true
    code-fold: false
    df-print: paged
    sidebar: haftalar
---

Bu derste kullanacaÄŸÄ±mÄ±z midiPISA veri seti;

Ã¶ÄŸrenci id (OGRENCIID), sÄ±nÄ±f dÃ¼zeyi (SINIF), cinsiyet (CINSIYET), anne eÄŸitim dÃ¼zeyi (Anne_Egitim), baba eÄŸitim dÃ¼zeyi (Baba_Egitim), okumaktan zevk alma (OKUMA_ZEVK), ST097Q01TA, ST097Q02TA, ST097Q03TA, ST097Q04TA, ST097Q05TA, okuma puanÄ± olasÄ± deÄŸer 1 (ODOKUMA1), okuma puanÄ± olasÄ± deÄŸer 2 (ODOKUMA2), okuma puanÄ± olasÄ± deÄŸer 3 (ODOKUMA3), okuma puanÄ± olasÄ± deÄŸer 4 (ODOKUMA4), okuma puanÄ± olasÄ± deÄŸer 5 (ODOKUMA5) deÄŸiÅŸkenleri olmak Ã¼zere toplam 16 deÄŸiÅŸkenden oluÅŸmaktadÄ±r. [Veri Seti](data/midiPISA.rda)

```{r}
load("data/midiPISA.rda")
```

Ã¶nce veriyi inceleyelim

```{r}
library(tidyverse)
library(dplyr)
dplyr::glimpse(midiPISA)
```

Anne_EÄŸitim kategorilerine bakalÄ±m

```{r}
midiPISA |> 
  distinct(Anne_Egitim )

```

Ortaya Ã§Ä±kan tabloyu incelediÄŸimizde aslÄ±nda **8 olasÄ±** deÄŸeri olduÄŸunu Ã¶ÄŸreniyoruz

Baba_EÄŸitim kategorilerine bakalÄ±m

```{r}
midiPISA |> 
  distinct(Baba_Egitim )
```

Ä°ki kategorik deÄŸiÅŸkenin (Ã¶rneÄŸin burada olduÄŸu gibi) her bir dÃ¼zey kombinasyonuna dÃ¼ÅŸen gÃ¶zlem sayÄ±larÄ±nÄ± gÃ¶stermek iÃ§in yaygÄ±n kullanÄ±lan bir yol **â€œkontenjans tablosuâ€ (contingency table)** oluÅŸturmaktÄ±r.

Bir kontenjans tablosu oluÅŸturmak iÃ§in Ã¼Ã§ adÄ±m gerekir:

1.  GÃ¶zlem sayÄ±larÄ±nÄ± saymak iÃ§in `count()` fonksiyonunu kullanmak

2.  Ä°lgilendiÄŸiniz deÄŸiÅŸkenleri `count()` fonksiyonu iÃ§ine belirtmek.

```{r}
midiPISA |> 
  count(Anne_Egitim, Baba_Egitim)
```

bu tabloyu geniÅŸ hale getirelim

ama Ã¶nce spss etiketlerini dÃ¼zeltelim

```{r}
library(sjlabelled)
midiPISA <- midiPISA %>% mutate_if(is_labelled, as_factor)
# Faktor degiskenlere duzey atama amacÄ±yla yazÄ±lan fonksiyon
levelsnames <- function(x){
  levels(x) <- names(attr(x,"labels"))
  x
}
# YazÄ±lan fonkisyonun faktor degiskenlere uygulanmasÄ±
midiPISA <-mutate_if(midiPISA,is.factor, levelsnames)
```

uzun veriyi geniÅŸ hale getirmek iÃ§in `pivot_wider`

```{r}
midiPISA |> 
  count(Anne_Egitim, Baba_Egitim) |>
  pivot_wider(names_from = Anne_Egitim, values_from = n)
```

BazÄ± dÃ¼zeylerde Ã§ok az sayÄ±da gÃ¶zlem olduÄŸunu ortaya koydu. Analizi basitleÅŸtirmek iÃ§in bu tÃ¼r dÃ¼zeyleri veri setinden Ã§Ä±karmak genellikle faydalÄ±dÄ±r.

Râ€™da bu iÅŸlem iki adÄ±m gerektirir:

1.  Ã‡ok az gÃ¶zleme sahip dÃ¼zeyleri iÃ§eren satÄ±rlarÄ± **filter()** ile Ã§Ä±karmak

2.  Bu dÃ¼zeyleri deÄŸiÅŸkenden tamamen kaldÄ±rmak iÃ§in **droplevels()** fonksiyonunu kullanmak

`droplevels()` fonksiyonunu, sÄ±fÄ±r gÃ¶zleme sahip dÃ¼zeyleri bir deÄŸiÅŸkenden temizlemek iÃ§in kullanÄ±rÄ±z.

```{r}
midiPISA_filtered <- midiPISA %>% 
  filter(!is.na(Anne_Egitim))%>%
  filter(!is.na(Baba_Egitim))%>%
  droplevels()

```

## Ã‡ubuk GrafiÄŸi

Ã§oÄŸu zaman kategorik deÄŸiÅŸkenleri **grafiksel olarak** gÃ¶stermek daha tablo olarak sunmaktan anlamlÄ±dÄ±r.

`geom_bar()` fonksiyonuna `position = "dodge"` argÃ¼manÄ±nÄ± eklemek, grafiÄŸin **yan yana Ã§ubuk grafik** (yani yÄ±ÄŸÄ±lmamÄ±ÅŸ) olmasÄ±nÄ± saÄŸlar.

Bu grafikleri oluÅŸturmak iÃ§in ÅŸu adÄ±mlarÄ± izleyin:

1.  **ggplot2** paketini yÃ¼kleyin.

2.  X ekseninde **Anne_Egitim** olacak ÅŸekilde, Ã§ubuklarÄ± karakterlerin **CINSIYET** deÄŸiÅŸkenine gÃ¶re doldurarak (fill) yan yana bir Ã§ubuk grafik oluÅŸturun.

3.  X ekseninde **CINSIYET** olacak ÅŸekilde, Ã§ubuklarÄ± karakterlerin **align** deÄŸiÅŸkenine gÃ¶re doldurarak ikinci yan yana Ã§ubuk grafiÄŸi oluÅŸturun.

```{r}
ggplot(midiPISA_filtered , aes(x = Anne_Egitim  , fill = CINSIYET  )) + 
  geom_bar() 

# yan yana 
ggplot(midiPISA_filtered , aes(x = Anne_Egitim  , fill = CINSIYET  )) + 
  geom_bar(position = "dodge")
```

Pek Ã§ok gÃ¶rselleÅŸtirmede, grafikteki **eksen etiketlerini** deÄŸiÅŸtirmek isteyebilirsiniz. Buradaki Ã¶rnekte â€œCINSIYETâ€ ve â€œAnne_Egitimâ€ etiketleri biraz daha aÃ§Ä±klayÄ±cÄ± hale getirilebilir.

Bir `ggplot()` grafiÄŸinin etiketlerini deÄŸiÅŸtirmek iÃ§in grafiÄŸe `+ labs()` katmanÄ± eklenir. Bu katmanda **x**, **y**, ve **fill** etiketlerini, ayrÄ±ca grafiÄŸin **baÅŸlÄ±ÄŸÄ±nÄ±** belirleyebilirsiniz.

```{r}
ggplot(midiPISA_filtered , aes(x = Anne_Egitim  , fill = CINSIYET  )) + 
  geom_bar(position = "dodge") + 
   labs(x = "EÄŸitim DÃ¼zeyi", 
       fill = "CINSIYET", 
       y = "Sayi") 
```

## SayÄ±lardan Oranlara

Bazen ham gÃ¶zlem sayÄ±larÄ± yararlÄ± olsa da Ã§oÄŸu zaman **oranlar** daha ilgi Ã§ekicidir. Bu oranlarÄ± kafamÄ±zdan hesaplamaya Ã§alÄ±ÅŸabiliriz ama R ile aÃ§Ä±kÃ§a hesaplamak Ã§ok daha kolaydÄ±r.

Her kategoriye dÃ¼ÅŸen gÃ¶zlemlerin **toplam iÃ§indeki oranlarÄ±nÄ±** gÃ¶rmek istiyorsak, Ã¶nceki tablomuzu biraz deÄŸiÅŸtirmemiz gerekir. Bunun iÃ§in her bir **cinsiyet** ve **sÄ±nÄ±f**kombinasyonunda gÃ¶zlemlerin toplam gÃ¶zlemler iÃ§indeki oranÄ±nÄ± hesaplayan bir sÃ¼tun eklemeliyiz.

Her dÃ¼zeydeki gÃ¶zlemleri saydÄ±ktan sonra, `mutate()` fonksiyonu ile bu dÃ¼zeylere dÃ¼ÅŸen gÃ¶zlemlerin oranÄ±nÄ± hesaplarÄ±z. Bu oranlarÄ± **prop** adlÄ± yeni bir deÄŸiÅŸkene kaydederiz.

Daha Ã¶nce olduÄŸu gibi, uzun tabloyu geniÅŸ tabloya dÃ¶nÃ¼ÅŸtÃ¼rÃ¼rÃ¼z (`pivot_wider()`). Ancak burada tabloya eklenmiÅŸ **ekstra bir sÃ¼tun (n)** vardÄ±r ve biz bu sÃ¼tunu tabloda istemiyoruz. Bu nedenle `id_cols` argÃ¼manÄ±na, tabloya dahil etmek istediÄŸimiz deÄŸiÅŸkenlerin isimlerini bir vektÃ¶r olarak belirtmemiz gerekir. BÃ¶ylece `names_from` ve `values_from` iÃ§in kullanÄ±lan deÄŸiÅŸkenler dÄ±ÅŸÄ±nda kalan sÃ¼tunlar korunmuÅŸ olur.

```{r}
midiPISA |>
  count(CINSIYET, SINIF) |>
  group_by(SINIF) |> 
  mutate(prop = n / sum(n)) |> 
  pivot_wider(id_cols = CINSIYET, 
              names_from = SINIF, values_from = prop)
```

## KoÅŸullu Oranlar

DeÄŸiÅŸkenler arasÄ±ndaki sistematik iliÅŸkilerle ilgileniyorsak, **koÅŸullu oranlara** bakmamÄ±z gerekir.

Bu koÅŸullu oranlarÄ±n tablosunu oluÅŸturmak iÃ§in, oranlarÄ± hesaplamadan Ã¶nce bir **gruplama deÄŸiÅŸkeni** belirtmemiz gerekir. Bu gruplamayÄ±, `group_by()` fonksiyonu ile yaparÄ±z.

ğŸ‘‰ **SatÄ±rlara gÃ¶re koÅŸullandÄ±rma (yani satÄ±rlarÄ±n toplamÄ± = 1).**

```{r}
ggplot(midiPISA, aes(x = CINSIYET, fill = SINIF)) +
  geom_bar(position = "fill") 
```

```{r}
ggplot(midiPISA, aes(fill = CINSIYET,  x= SINIF)) +
  geom_bar(position = "fill") 
```

## Tek DeÄŸiÅŸkenin DaÄŸÄ±lÄ±mÄ±

Tek bir deÄŸiÅŸken (Ã¶rneÄŸin CINSIYET) iÃ§in frekans tablosu oluÅŸturmak iÃ§in yine `count()` fonksiyonunu kullanabiliriz. Bu daha basit tabloyu dÃ¼ÅŸÃ¼nmenin bir yolu da ÅŸudur: Orijinal iki yÃ¶nlÃ¼ tabloda (iki kategorik deÄŸiÅŸkenle) her bir SINIF dÃ¼zeyindeki hÃ¼creleri toplayarak Ã¶zetledik. DiÄŸer deÄŸiÅŸkenler Ã¼zerinden toplama yaptÄ±ÄŸÄ±mÄ±z iÃ§in bu Ã¶zetleme bazen marjinal daÄŸÄ±lÄ±m (marginal distribution) olarak adlandÄ±rÄ±lÄ±r.

```{r}
midiPISA |> 
  count(CINSIYET)
```

```{r}
midiPISA |> 
  count(CINSIYET,SINIF) |> 
  pivot_wider(names_from = CINSIYET , values_from = n)
```

## Basit Ã‡ubuk Grafik

Basit Ã§ubuk grafik oluÅŸturmanÄ±n sÃ¶zdizimi oldukÃ§a basittir; bunu dersin baÅŸÄ±nda gÃ¶rmÃ¼ÅŸtÃ¼k. Bunun iÃ§in `aes` iÃ§inden **fill = align** argÃ¼manÄ±nÄ± Ã§Ä±karmamÄ±z yeterlidir.

-   cinsiyet

```{r}
ggplot(midiPISA, aes(x = CINSIYET)) +
  geom_bar()
```

-   sÄ±nÄ±f dÃ¼zeyi

```{r}

# Yeni sÄ±ralamayla Ã§ubuk grafik
ggplot(midiPISA, aes(x = SINIF)) +
  geom_bar(fill = "steelblue") +
  labs(title = "SÄ±nÄ±f DÃ¼zeylerinin DaÄŸÄ±lÄ±mÄ±",
       x = "SÄ±nÄ±f",
       y = "Ã–ÄŸrenci SayÄ±sÄ±")
```

## Faceting (Alt Grafikler)

Tek bir deÄŸiÅŸkenin daÄŸÄ±lÄ±mÄ±nÄ± gÃ¶rselleÅŸtirmenin baÅŸka yararlÄ± bir yolu, onu baÅŸka bir deÄŸiÅŸkenin belirli bir deÄŸerine gÃ¶re koÅŸullandÄ±rmaktÄ±r. Ã–rneÄŸin yalnÄ±zca **10. SÄ±nÄ±f** Ã¶ÄŸrencileri iÃ§in **CINSIYET** daÄŸÄ±lÄ±mÄ±nÄ± gÃ¶rmek isteyebiliriz.

Bunu yapmak iÃ§in:

-   Veri setini filtreleyip sadece **SINIF= "10"** olanlarla bir Ã§ubuk grafik Ã§izebiliriz,

-   Ya da **faceting** tekniÄŸini kullanabiliriz. Faceting, veriyi bir kategorik deÄŸiÅŸkenin dÃ¼zeylerine gÃ¶re alt gruplara ayÄ±rÄ±r ve her dÃ¼zey iÃ§in ayrÄ± bir grafik oluÅŸturur.

## Facetâ€™li Ã‡ubuk Grafikler

`ggplot2`â€™de faceting uygulamak iÃ§in grafiÄŸe sadece bir katman daha ekleriz. Bunun iÃ§in `facet_wrap()` fonksiyonu kullanÄ±lÄ±r. Ä°Ã§ine **tilde (\~)** ve facet yapmak istediÄŸimiz deÄŸiÅŸkenin adÄ± yazÄ±lÄ±r (Ã¶rn. `~`**SINIF**).

Bu, yukarÄ±daki grafiÄŸi oluÅŸtur ama bunu **SINIF**deÄŸiÅŸkenine gÃ¶re parÃ§ala anlamÄ±na gelir.

YÃ¼m sÄ±nÄ±f dÃ¼zeyleri iÃ§in grafikler elde edilir.

```{r}
ggplot(midiPISA, aes(x = CINSIYET)) +
  geom_bar() +
  facet_wrap(~SINIF)
```

## Faceting ve YÄ±ÄŸma

Ã–zÃ¼nde, facetâ€™li grafik dersin baÅŸÄ±nda gÃ¶rdÃ¼ÄŸÃ¼mÃ¼z **yÄ±ÄŸÄ±lmÄ±ÅŸ Ã§ubuk grafiklerin** farklÄ± bir dÃ¼zenlemesidir.

Facetâ€™ler ya da yÄ±ÄŸÄ±lmÄ±ÅŸ Ã§ubuklar:

-   Tek bir deÄŸiÅŸkenin daÄŸÄ±lÄ±mÄ±nÄ± gÃ¶rmek iÃ§in tek bir facetâ€™e ya da Ã§ubuÄŸa,

-   DeÄŸiÅŸkenler arasÄ±ndaki iliÅŸkiyi gÃ¶rmek iÃ§in facetâ€™ler ya da Ã§ubuklar arasÄ±nda karÅŸÄ±laÅŸtÄ±rma yapmaya olanak tanÄ±r.

```{r}
ggplot(midiPISA, aes(x = CINSIYET ,fill = SINIF)) +
  geom_bar() 
```

## Pasta GrafiÄŸi

Pasta grafiÄŸi, kategorik verileri gÃ¶stermenin yaygÄ±n bir yoludur. Dilimlerin bÃ¼yÃ¼klÃ¼ÄŸÃ¼, o dÃ¼zeydeki gÃ¶zlem oranÄ±nÄ± gÃ¶sterir.

```{r}
ggplot(midiPISA, aes(x = "", fill = SINIF)) +
  geom_bar(width = 1) +
  coord_polar("y") +
  labs(title = "SÄ±nÄ±f DaÄŸÄ±lÄ±mÄ± (Pie Chart)", fill = "SÄ±nÄ±f")
```

-   cinsiyete gÃ¶re

```{r}
ggplot(midiPISA, aes(x = "", fill = SINIF)) +
  geom_bar(width = 1) +
  coord_polar("y") +
  facet_wrap(~CINSIYET) +
  labs(title = "Cinsiyete GÃ¶re SÄ±nÄ±f DaÄŸÄ±lÄ±mÄ±", fill = "SÄ±nÄ±f")

```

-   oranlarÄ± ekle

```{r}
pie_data <- midiPISA %>%
  count(CINSIYET, SINIF) %>%
  group_by(CINSIYET) %>%
  mutate(prop = n / sum(n),
         label = scales::percent(prop, accuracy = 1))

# Pasta grafik + etiketler
ggplot(pie_data, aes(x = "", y = prop, fill = SINIF)) +
  geom_col(width = 1) +
  coord_polar("y") +
  facet_wrap(~CINSIYET) +
  geom_text(aes(label = label),
            position = position_stack(vjust = 0.5), # dilimin ortasÄ±na koy
            color = "white",
            size = 4) +
  labs(title = "Cinsiyete GÃ¶re SÄ±nÄ±f DaÄŸÄ±lÄ±mÄ±",
       fill = "SÄ±nÄ±f",
       x = NULL, y = NULL) +
  theme_void()
```

```{r}
library(dplyr)

pie_data <- midiPISA %>%
  count(SINIF) %>%
  mutate(prop = n / sum(n),
         label = scales::percent(prop, accuracy = 1))

ggplot(pie_data, aes(x = "", y = prop, fill = SINIF)) +
  geom_col(width = 1, color = "white") +
  coord_polar("y") +
  geom_text(aes(label = label),
            position = position_stack(vjust = 0.5),
            color = "white", size = 4) +
  labs(title = "SÄ±nÄ±f DaÄŸÄ±lÄ±mÄ± (%)", fill = "SÄ±nÄ±f") +
  theme_void()

```

```{r}
library(dplyr)
library(plotly)

# Veri: SINIF deÄŸiÅŸkenine gÃ¶re sayÄ±lar
pie_data <- midiPISA %>%
  count(SINIF)

# EtkileÅŸimli pie chart
plot_ly(pie_data,
        labels = ~SINIF,
        values = ~n,
        type = "pie",
        textinfo = "label+percent",   # etiket + yÃ¼zde
        insidetextorientation = "radial") %>%
  layout(title = "SÄ±nÄ±f DaÄŸÄ±lÄ±mÄ± (Pie Chart - Plotly)")
```

## Dotplot

SayÄ±sal verileri temsil etmenin en doÄŸrudan yolu **nokta grafiÄŸi (dotplot)** kullanmaktÄ±r. Burada her bir gÃ¶zlem, x-eksenindeki uygun deÄŸerine yerleÅŸtirilen bir nokta ile gÃ¶sterilir. Benzer deÄŸerlere sahip gÃ¶zlemler, diÄŸerlerinin Ã¼stÃ¼ne yÄ±ÄŸÄ±lÄ±r. Nokta grafiÄŸini histogramÄ±n bir â€œkardeÅŸiâ€ gibi dÃ¼ÅŸÃ¼nebilirsiniz, ancak burada her sÃ¼tunda kaÃ§ gÃ¶zlem olduÄŸunu tam olarak bilirsiniz, Ã§Ã¼nkÃ¼ noktalarÄ± tek tek sayabilirsiniz. Ã–nemli bir nokta ise, bu grafik histogramdan Ã§ok daha az bilgi kaybÄ± iÃ§erir; hatta yalnÄ±zca bu grafik verilse bile veri setini neredeyse yeniden oluÅŸturabilirsiniz. Tahmin edebileceÄŸiniz gibi, gÃ¶zlem sayÄ±sÄ± Ã§ok arttÄ±ÄŸÄ±nda bu grafikleri okumak zorlaÅŸmaya baÅŸlar.

AÅŸaÄŸÄ±daki kod, veri setindeki rasgele seÃ§ilmiÅŸ 100 kiÅŸinin okumaktan alÄ±ÄŸÄ± zevk iÃ§in nokta grafiÄŸi Ã¼retmektedir. Dikkat ederseniz, yalnÄ±zca tek bir sayÄ±sal deÄŸiÅŸkenle (aÄŸÄ±rlÄ±k) ilgilendiÄŸimiz iÃ§in estetiklerde (aesthetics) yalnÄ±zca bu deÄŸiÅŸken belirtilmiÅŸtir. AyrÄ±ca, bu deÄŸiÅŸken x-estetiÄŸi olarak tanÄ±mlanmÄ±ÅŸtÄ±r Ã§Ã¼nkÃ¼ sayÄ±sal bir deÄŸiÅŸkeni x-ekseninde gÃ¶stermek â€œstandartâ€tÄ±r. Son olarak, grafiÄŸe noktalarÄ± eklemek iÃ§in **geom_dotplot()** fonksiyonunun kullanÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶rÃ¼yoruz. Bu fonksiyonun **dotsize** adlÄ± isteÄŸe baÄŸlÄ± bir argÃ¼manÄ± vardÄ±r; bu argÃ¼man noktalarÄ±n ne kadar bÃ¼yÃ¼k olacaÄŸÄ±nÄ± belirler (0â€™a yakÄ±n deÄŸerler noktalarÄ± kÃ¼Ã§Ã¼ltÃ¼r, 1â€™e yakÄ±n deÄŸerler bÃ¼yÃ¼tÃ¼r).

```{r}
set.seed(100)
midiPISA_filtered %>% sample_n(100) %>% 
ggplot( aes(x = OKUMA_ZEVK  )) +
  geom_dotplot(dotsize = 0.4)
```

Nokta grafiÄŸinde dikkat edersek, y-ekseni biraz kafa karÄ±ÅŸtÄ±rÄ±cÄ±dÄ±r Ã§Ã¼nkÃ¼ 0.0 ve 1.0 deÄŸerlerinin neyi ifade ettiÄŸi aÃ§Ä±k deÄŸildir. Bu durum, **ggplot2â€™nin talihsiz bir sÄ±nÄ±rlÄ±lÄ±ÄŸÄ±dÄ±r**: x-ekseni boyunca gruplama (binning) ve y-ekseni boyunca yÄ±ÄŸma (stacking) iÅŸlemi, anlamlÄ± olmayan bir y-ekseni ile sonuÃ§lanÄ±r. Grafik Ã§izim becerilerimiz ilerledikÃ§e, y-ekseni tamamen gizlemeyi ya da noktalarÄ±n sayÄ±sÄ±yla daha uyumlu olacak ÅŸekilde Ã¶lÃ§eÄŸi manuel olarak ayarlamayÄ± tercih edebiliriz.

## Histogram

En yaygÄ±n kullanÄ±lan grafik tÃ¼rlerinden biri **histogramdÄ±r**. Histogram, bu sorunu Ã§Ã¶zmek iÃ§in noktalarÄ± x-ekseni boyunca kutulara (bin) toplar ve her sÃ¼tunun yÃ¼ksekliÄŸi, o kutuya dÃ¼ÅŸen gÃ¶zlem sayÄ±sÄ±nÄ± gÃ¶sterir. Bu gruplama (binning) nedeniyle veri setini eksiksiz bir ÅŸekilde yeniden oluÅŸturmak mÃ¼mkÃ¼n deÄŸildir; ancak bu yÃ¶ntem, daÄŸÄ±lÄ±mÄ±n genel ÅŸeklini daha net gÃ¶rmemizi saÄŸlar.

Dikkat ederseniz, kodda deÄŸiÅŸen tek ÅŸey **geom_dotplot()** fonksiyonunun **geom_histogram()** ile deÄŸiÅŸtirilmesidir.

```{r}

midiPISA %>% 
ggplot( aes(x = OKUMA_ZEVK  )) +
  geom_histogram()
```

**Not:** YukarÄ±daki kodu Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ±mÄ±zda bir mesaj alÄ±yoruz. Bu mesaj bize, uygun bir *binwidth* seÃ§ildiÄŸini ve ayrÄ±ca 69 adet eksik deÄŸer bulunduÄŸunu bildiriyor. Bu bir hata deÄŸil, yalnÄ±zca **ggplot()** fonksiyonunun size bilgi vermesidir!

### Histogram kutularÄ± (bins)

EÄŸer histogramÄ±n basamaklÄ± (kesikli) yapÄ±sÄ± sizi rahatsÄ±z ederse, birkaÃ§ seÃ§eneÄŸiniz vardÄ±r.

-   Ä°lk olarak, **bins** veya **binwidth** argÃ¼manlarÄ±yla oynayarak histogramÄ±n olabildiÄŸince sÃ¼rekli gÃ¶rÃ¼nmesini saÄŸlayacak kutu sayÄ±sÄ±nÄ± bulabilirsiniz.

-   Ä°kinci olarak, bir sonraki bÃ¶lÃ¼mde gÃ¶receÄŸimiz **yoÄŸunluk grafiÄŸi (density plot)** kullanabilirsiniz.

**ggplot2**, varsayÄ±lan olarak mantÄ±klÄ± bir *binwidth* seÃ§meye Ã§alÄ±ÅŸÄ±r; ancak bu seÃ§eneÄŸi kendiniz belirleyerek geÃ§ersiz kÄ±labilirsiniz. **geom_histogram()** iÃ§indeki *bins* ve *binwidth* argÃ¼manlarÄ±, **geom_dotplot()** fonksiyonundaki *dotsize* argÃ¼manÄ±na benzer ÅŸekilde isteÄŸe baÄŸlÄ±dÄ±r ve histogramÄ±n bir yÃ¶nÃ¼nÃ¼ kontrol eder. Ã–rneÄŸin, *binwidth = 5* seÃ§ersek histogram daha dÃ¼zgÃ¼n gÃ¶rÃ¼nÃ¼r. Alternatif olarak, **geom_histogram()**â€™Ä±n varsayÄ±lanÄ± olan 30 kutu yerine istediÄŸimiz kutu sayÄ±sÄ±nÄ± belirtebiliriz.

```{r}
midiPISA %>% 
ggplot( aes(x = ODOKUMA1  )) +
  geom_histogram(binwidth = 5)
```

```{midiPISA %>%}
ggplot( aes(x = ODOKUMA1  )) +
  geom_histogram(binwidth = 30)
```

```{r}
midiPISA %>% 
ggplot( aes(x = ODOKUMA1  )) +
  geom_histogram(binwidth = 60)
```

## YoÄŸunluk grafiÄŸi (Density plot)

YoÄŸunluk grafiÄŸi, histogramÄ±n ÅŸeklini **dÃ¼zgÃ¼n (smooth) bir Ã§izgiyle** temsil eder. Bunu, histogramÄ±n Ã¼zerine yumuÅŸatÄ±lmÄ±ÅŸ bir Ã§izgi Ã§izmek gibi dÃ¼ÅŸÃ¼nebilirsiniz; bÃ¶ylece daÄŸÄ±lÄ±mÄ±n genel ÅŸeklini daha pÃ¼rÃ¼zsÃ¼z bir ÅŸekilde gÃ¶sterir. Ancak yoÄŸunluk grafiÄŸi, verideki ani sÄ±Ã§ramalara karÅŸÄ± oldukÃ§a hassastÄ±r, bu yÃ¼zden yalnÄ±zca **bÃ¼yÃ¼k Ã¶rneklemlerle** kullanÄ±lmasÄ± Ã¶nerilir.

Kodumuzda deÄŸiÅŸen tek satÄ±r, fonksiyonun **geom_density()** olarak deÄŸiÅŸtirilmesidir.

```{r}
midiPISA %>% 
ggplot( aes(x = ODOKUMA1  )) +
geom_density()
```

#### Bandwidth (bant geniÅŸliÄŸi)

YoÄŸunluk grafiÄŸinin daha dÃ¼zgÃ¼n gÃ¶rÃ¼nmesini istiyorsak, grafiÄŸin **bandwidth** (bant geniÅŸliÄŸi) deÄŸerini artÄ±rabiliriz. Bandwidth arttÄ±kÃ§a grafik daha pÃ¼rÃ¼zsÃ¼z hale gelir; daha kÃ¼Ã§Ã¼k bandwidth deÄŸerleri ise daha dalgalÄ± (volatil) gÃ¶rÃ¼nÃ¼mlere yol aÃ§ar.

Peki grafiklerimiz iÃ§in â€œen iyiâ€ binwidth veya bandwidth deÄŸerini nasÄ±l belirleyeceÄŸiz? Genellikle varsayÄ±lan ayarlar makuldÃ¼r; ancak farklÄ± Ã¶lÃ§eklerdeki yapÄ±larÄ± gÃ¶rebilmek iÃ§in hem daha pÃ¼rÃ¼zsÃ¼z hem de daha ayrÄ±ntÄ±lÄ± versiyonlarla oynamak iyi bir uygulamadÄ±r. Histogramdaki **bins** argÃ¼manÄ±na benzer ÅŸekilde, bandwidth deÄŸeri de **geom_density()** fonksiyonunun grafiÄŸi oluÅŸtururken kullandÄ±ÄŸÄ± kutu sayÄ±sÄ±nÄ± belirler. Daha bÃ¼yÃ¼k bandwidth deÄŸerleri daha az kutu Ã¼zerinden yumuÅŸatma yapar, bu yÃ¼zden daha pÃ¼rÃ¼zsÃ¼z bir yoÄŸunluk grafiÄŸi elde etmek iÃ§in **daha bÃ¼yÃ¼k bw deÄŸerleri** seÃ§ebilirsiniz.

AÅŸaÄŸÄ±daki alÄ±ÅŸtÄ±rmada farklÄ± **bandwidth** deÄŸerlerini deneyin.

```{r}
midiPISA %>% 
ggplot( aes(x = ODOKUMA1  )) +
  geom_density(bw = 100)
```

### Kutu grafiÄŸi (Boxplot)

Histogram gibi, **kutu grafiÄŸi (boxplot)** de ham verileri doÄŸrudan gÃ¶stermez. Bunun yerine, verilerin Ã¶zet istatistiklerini gÃ¶rselleÅŸtirir. Bir kutu grafiÄŸi:

-   DaÄŸÄ±lÄ±mÄ±n merkezini (**medyan**),

-   Verilerin orta yarÄ±sÄ±nÄ± ayÄ±ran deÄŸerleri (**birinci ve Ã¼Ã§Ã¼ncÃ¼ Ã§eyrekler**),

-   Verilerin bÃ¼yÃ¼k Ã§oÄŸunluÄŸunu gÃ¶steren deÄŸerleri (**bÄ±yÄ±klarÄ±n uÃ§larÄ±**)

Ã§izer.

Dikkat ederseniz, R kodumuzda deÄŸiÅŸen tek satÄ±r **geom_boxplot()** fonksiyonunun kullanÄ±lmasÄ±dÄ±r.

```{r}
midiPISA %>% 
ggplot( aes(x = ODOKUMA1  )) +
 geom_boxplot()
```

**Kutu, verilerin merkezi Ã§oÄŸunluÄŸunu (bÃ¼yÃ¼k kÄ±smÄ±nÄ±) temsil eder.**

**BÄ±yÄ±klar, verilerin neredeyse tamamÄ±nÄ± kapsar.**

AykÄ±rÄ± (uÃ§) deÄŸerler ise noktalarla gÃ¶sterilir.

## Boxplotlar & Dotplotlar

Bir boxplotâ€™un nasÄ±l oluÅŸturulduÄŸunu daha iyi anlamak iÃ§in **Ã¶nce bir dotplotâ€™tan baÅŸlayalÄ±m**.

Boxplot Ã¼Ã§ temel Ã¶zet istatistik etrafÄ±nda ÅŸekillenir:

-   **Birinci Ã§eyrek (Q1):** Verilerin %25â€™i bu deÄŸerin altÄ±ndadÄ±r.

-   **Ä°kinci Ã§eyrek (Q2 / medyan):** Verilerin %50â€™si bu deÄŸerin altÄ±ndadÄ±r. Yani veri setinin tam ortasÄ±nda yer alÄ±r.

-   **ÃœÃ§Ã¼ncÃ¼ Ã§eyrek (Q3):** Verilerin %75â€™i bu deÄŸerin altÄ±ndadÄ±r.

MedyanÄ±n ikinci Ã§eyrek olarak adlandÄ±rÄ±lmasÄ±nÄ±n nedeni, verilerin yarÄ±sÄ±nÄ±n (iki Ã§eyreÄŸin) onun altÄ±nda, yarÄ±sÄ±nÄ±n ise Ã¼stÃ¼nde olmasÄ±dÄ±r. Benzer ÅŸekilde, birinci Ã§eyrek verilerin yalnÄ±zca dÃ¶rtte birini (%25) altÄ±na alÄ±rken, Ã¼Ã§Ã¼ncÃ¼ Ã§eyrek verilerin dÃ¶rtte Ã¼Ã§Ã¼nÃ¼ (%75) altÄ±na alÄ±r.

Bu Ã¼Ã§ sayÄ±, boxplotâ€™taki **kutuyu** oluÅŸturur:

-   Medyan ortada,

-   Q1 ve Q3 ise kutunun kenarlarÄ±nda yer alÄ±r.

Bir boxplotâ€™a baktÄ±ÄŸÄ±nÄ±zda **her zaman bilmeniz gereken ÅŸey**, verilerin orta yarÄ±sÄ±nÄ±n bu kutunun iÃ§inde olduÄŸudur.

Kutudan dÄ±ÅŸarÄ± uzanan Ã§izgilere **â€œbÄ±yÄ±klarâ€ (whiskers)** denir. BÄ±yÄ±klarÄ±n nerede Ã§izileceÄŸine dair Ã§eÅŸitli kurallar vardÄ±r. **ggplot2**â€™nin kullandÄ±ÄŸÄ± kural ÅŸudur:

-   Kutunun uzunluÄŸunu (IQR = Q3 âˆ’ Q1) 1.5 ile Ã§arpar,

```         
Daha sonra alt ve Ã¼st sÄ±nÄ±rlarÄ± (fences) ÅŸu ÅŸekilde belirler:

-    **Alt sÄ±nÄ±r:** Q1 âˆ’ 1.5 Ã— IQR

-    **Ãœst sÄ±nÄ±r:** Q3 + 1.5 Ã— IQR
```

BÄ±yÄ±klar, en fazla bu sÄ±nÄ±rlara kadar uzatÄ±lÄ±r. EÄŸer bir gÃ¶zlem bu sÄ±nÄ±rlarÄ±n dÄ±ÅŸÄ±nda kalÄ±yorsa, **aykÄ±rÄ± deÄŸer (outlier)** olarak noktalarla gÃ¶sterilir.

ğŸ“Œ Boxplotâ€™un en pratik Ã¶zelliklerinden biri de budur: Verilerin bÃ¼yÃ¼k kÄ±smÄ±ndan uzak olan deÄŸerleri **otomatik olarak iÅŸaretleyerek potansiyel aykÄ±rÄ± deÄŸerleri** tespit etmenize yardÄ±mcÄ± olur.

### YoÄŸunluk grafikleri vs. kutu grafikleri

Kutu grafikleri, Ã¶zellikle **birden fazla daÄŸÄ±lÄ±mÄ± aynÄ± anda karÅŸÄ±laÅŸtÄ±rmanÄ±z gerektiÄŸinde** ve **aykÄ±rÄ± deÄŸerleri tespit etmek istediÄŸinizde** gerÃ§ekten Ã§ok iÅŸe yarar. Ancak zayÄ±f yÃ¶nlerinden biri, bir daÄŸÄ±lÄ±mÄ±n birden fazla tepe noktasÄ± (modu) olup olmadÄ±ÄŸÄ±nÄ± gÃ¶sterememesidir.

Buradaki yoÄŸunluk grafiÄŸini dÃ¼ÅŸÃ¼nÃ¼n: iki farklÄ± tepe noktasÄ± (iki mod) vardÄ±r. AynÄ± daÄŸÄ±lÄ±mÄ±n kutu grafiÄŸini Ã§izdiÄŸimizde ise bu Ã¶nemli yapÄ± gÃ¶z ardÄ± edilir, Ã§Ã¼nkÃ¼ kutu grafiÄŸi her zaman yalnÄ±zca tek bir kutu gÃ¶sterir.

### Kutu grafikleri ile aykÄ±rÄ± deÄŸer tespiti

Bir kutu grafiÄŸi, daÄŸÄ±lÄ±mÄ±n merkezi ve yayÄ±lÄ±mÄ±nÄ± gÃ¶stermenin yanÄ± sÄ±ra, **aykÄ±rÄ± deÄŸerleri tespit etmenin gÃ¶rsel bir yolunu** da sunar. Ã–rneÄŸin, **msrp (Ã¼retici tarafÄ±ndan Ã¶nerilen satÄ±ÅŸ fiyatÄ±)** deÄŸiÅŸkenine bu yÃ¶ntemi uygulayarak, olaÄŸanÃ¼stÃ¼ pahalÄ± veya ucuz arabalarÄ± tespit edebilirsiniz.

Bunu yapmak iÃ§in ÅŸu adÄ±mlarÄ± izleyelim:

1.  **msrp deÄŸiÅŸkeninin kutu grafiÄŸini oluÅŸturun.**

2.  En bÃ¼yÃ¼k 3â€“5 aykÄ±rÄ± deÄŸeri hariÃ§ tutarak yeni bir veri seti oluÅŸturun. Bunun iÃ§in satÄ±rlarÄ± filtreleyip yalnÄ±zca **100.000 \$â€™dan ucuz arabalarÄ±** tutarak **cars_no_out** adlÄ± yeni bir veri seti oluÅŸturun.

3.  Bu azaltÄ±lmÄ±ÅŸ veri setiyle **msrpâ€™nin yeni kutu grafiÄŸini oluÅŸturun.**

4.  Ä°ki grafiÄŸi karÅŸÄ±laÅŸtÄ±rÄ±n.

```{r}
# Construct boxplot
midiPISA %>% 
ggplot( aes(x = ODOKUMA1  )) +
  geom_boxplot()

# Exclude outliers from data
midiPISA_no_out <- midiPISA |>
  filter(ODOKUMA1 < 600)
  
# Construct boxplot of msrp using the reduced dataset
ggplot(data = midiPISA_no_out, aes(x = ODOKUMA1)) + 
  geom_boxplot()
```

### Ä°ki deÄŸiÅŸkenin gÃ¶rselleÅŸtirilmesi

EÄŸer yalnÄ±zca **tek bir sayÄ±sal deÄŸiÅŸkenin daÄŸÄ±lÄ±mÄ±yla** ilgileniyorsanÄ±z, bunu Ã¼Ã§ ÅŸekilde gÃ¶rebilirsiniz. Birincisi, **marjinal daÄŸÄ±lÄ±ma** bakmaktÄ±r; Ã¶rneÄŸin okuma puanlarÄ±nÄ±n basit daÄŸÄ±lÄ±mÄ± gibi.

Ancak, verinin farklÄ± bir alt kÃ¼mesi iÃ§in daÄŸÄ±lÄ±ma bakmak istersek â€” Ã¶rneÄŸin yalnÄ±zca kÄ±zlar iÃ§in â€” grafiÄŸe ikinci bir deÄŸiÅŸken ekleyebiliriz.

Ä°ncelediÄŸimiz grafiklere ikinci bir deÄŸiÅŸkeni dahil etmenin iki ana yolu vardÄ±r:

1.  **Facet eklemek** (grafiÄŸi alt panellere ayÄ±rmak),

2.  **Renk eklemek** (deÄŸerleri renklerle ayÄ±rt etmek).

```{r}


# Histogram
midiPISA %>% 
  ggplot(aes(x = ODOKUMA1)) +
  geom_histogram(binwidth = 10, fill = "skyblue", color = "white") +
  labs(x = "Okuma PuanÄ±", y = "Frekans",
       title = "Histogram - ODOKUMA1")

# Density Plot
midiPISA %>% 
  ggplot(aes(x = ODOKUMA1)) +
  geom_density(fill = "lightgreen", alpha = 0.5) +
  labs(x = "Okuma PuanÄ±", y = "YoÄŸunluk",
       title = "Density Plot - ODOKUMA1")

# Boxplot
midiPISA %>% 
  ggplot(aes(y = ODOKUMA1)) +  # Boxplot'ta x yerine y kullanmak daha uygun
  geom_boxplot(fill = "orange", alpha = 0.6) +
  labs(y = "Okuma PuanÄ±",
       title = "Boxplot - ODOKUMA1")

```

### Facetâ€™lenmiÅŸ histogramlar

Bir histogram kullanarak otoyol yakÄ±t tÃ¼ketiminin (highway mileage) daÄŸÄ±lÄ±mÄ±na bakalÄ±m, fakat bu kez **araÃ§larÄ±n pick-up kamyonet olup olmamasÄ±na gÃ¶re ayrÄ± grafikler** Ã§izelim.

Bu ayrÄ± grafikleri oluÅŸturmak iÃ§in `ggplot()` fonksiyonuna bir **facet_wrap()** katmanÄ± ekleyebiliriz. Facet yapmak istediÄŸimiz deÄŸiÅŸkeni **facet_wrap()** fonksiyonunun iÃ§ine yazÄ±yoruz.

```{r}
midiPISA%>% 
  ggplot(aes(x = ODOKUMA1)) +
  geom_histogram(binwidth = 10, fill = "skyblue", color = "white") +
  facet_wrap(~  CINSIYET) +
  labs(x = "Okuma PuanÄ±", y = "Frekans",
       title = "ODOKUMA1 DaÄŸÄ±lÄ±mÄ± - Cinsiyete GÃ¶re Facet")
```

-   `facet_wrap(~ CINS)` ifadesi her cinsiyet iÃ§in ayrÄ± histogram Ã§iziyor.
-   
-   Ä°sterseniz `~ OKUL_TURU` veya baÅŸka kategorik deÄŸiÅŸkeni de koyabilirsiniz.

GrafiÄŸe bakÄ±ldÄ±ÄŸÄ±nda, **pick-up olmayan araÃ§larÄ±n (FALSE deÄŸerleri) sayÄ±sÄ±nÄ±n pick-up araÃ§lardan (TRUE deÄŸerleri) Ã§ok daha fazla** olduÄŸu aÃ§Ä±kÃ§a gÃ¶rÃ¼lÃ¼yor. Grafik ayrÄ±ca, **tipik bir pick-up aracÄ±n yakÄ±t verimliliÄŸinin (mileage) tipik bir pick-up olmayan araca gÃ¶re Ã§ok daha dÃ¼ÅŸÃ¼k** olduÄŸunu gÃ¶steriyor. Bunun yanÄ±nda, **pick-up olmayan araÃ§larÄ±n deÄŸiÅŸkenliÄŸinin pick-up araÃ§lara gÃ¶re daha fazla** olduÄŸu da dikkat Ã§ekiyor.

### 
